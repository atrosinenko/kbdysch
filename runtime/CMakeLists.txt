option(USE_LKL          "Link with LKL (otherwise just build invokers for the host kernel)" ON)
option(USE_INVOKERS     "Build fuzzers that require invokers to be generated first" ON)
option(FAKE_TIME        "Report fake time values to Pth, LKL, etc. to increase the stability" ON)
option(USE_COMPACT_ENCODING "Read more compact descriptions when generating strings and buffer contents" ON)
set(   LKL_INCLUDE_PATH "${PROJECT_BINARY_DIR}/lkl-include" CACHE STRING "Full path to the tools/lkl/include of LKL build")
set(   LKL_LIB_PATH     "${PROJECT_BINARY_DIR}/liblkl.so"   CACHE STRING "Full path to LKL library file")

set(GENERATED_INVOKER_DIR "${CMAKE_CURRENT_LIST_DIR}/generated")
include_directories(include)

if (USE_LKL)
    link_libraries(${LKL_LIB_PATH})
    include_directories(${LKL_INCLUDE_PATH})
    add_definitions(-DUSE_LKL)
endif()

if (USE_COMPACT_ENCODING)
    add_definitions(-DUSE_COMPACT_ENCODING)
endif()

set(OVERRIDE_LIBS "")
add_subdirectory(common)
include(common/Helpers.cmake)

RegisterInvoker(fs)
RegisterHarnessWithInvoker(fsfuzz fs)
RegisterHarnessWithInvoker(fusefuzz fs)
RegisterHarness(bpffuzz)
RegisterHarness(hidfuzz)
RegisterHarness(partfuzz)
